/*
 * ######################################################
 * #  jambula services                                  #
 * #  ****************                                  #
 * #  Tip: Use `icinga2 object list --type Service` to  #
 * #  list all service objects after running            # 
 * # configuration validation (`icinga2 daemon -C`).    #
 * #						        #
 * ######################################################
 */


/*
 * *******************
 * Systemd *
 * *******************
 * Used to monitor status of systemd - notify of failed units
 */

object Service "systemd" {
  import "jambula-01-service"

  host_name = "JambulaTV"
  check_command = "systemd"

  vars.osd.enabled = "yes"
  vars.osd.message = "System Services: One or more services failed.  For help, please contact support@jambulatv.com"
  vars.osd.interval = "2h"
}

/*
 * ***********************
 * /JambulaTV Media Disk *
 * ***********************
 * Used to check disk space at /JambulaTV
 */

object Service "Media Disk Space" {
  import "jambula-01-service"

  host_name = "JambulaTV"
  check_command = "disk"

  vars.disk_partitions = "/JambulaTV"
  vars.disk_wfree = "5%"
  vars.disk_cfree = "3%"
  display_name = "Media Disk Space"

  vars.osd.enabled = "yes"
  vars.osd.message = "Disk Space: You are running Low on disk space! Please clear the space in /JambulaTV"
  vars.osd.interval = "1h"
}

/*
 * ***********************************
 * /JambulaTV DVB-T Channels Missing *
 * ***********************************
 * Used to check if DVB-T channels are corrupted
 */

object Service "DVB-T2 Network" {
  import "jambula-01-service"

  host_name = "JambulaTV"
  check_command = "dvbt2-network"

  vars.osd.enabled = "yes"
  vars.osd.message = "Live TV: Your DVB-T2 Channel list is missing or corrupted.  Please add a DVB-T network and map your channels. Visit the link at: http://$host.address$:9981"
  vars.osd.interval = "1m"
}

/*
 * *******************
 * WiFi AP Discovery *
 * *******************
 * Used to scan for preferred wireless access point
 */

object Service "Discover Wifi Access Point" {
  import "jambula-01-service"

  host_name = "JambulaTV"
  check_command = "wifi_ap"
  event_command = "wifi-ap-status-event"

  vars.osd.enabled = "yes"
  vars.osd.message = "WiFi Access: Your preferred Wireless Access Point has been detected"
  vars.osd.interval = "once"
}

/*
 * ********************
 * WiFi User Presence *
 * ********************
 * Used to detect presence of selected user at home
 */

object Service "Detect Presence of User" {
  import "jambula-03-service"

  host_name = "JambulaTV"
  check_command = "wifi_user"
  event_command = "wifi-user-status-event"

  vars.osd.enabled = "yes"
  vars.osd.message = "$service.output$"
  vars.osd.interval = "once"
}

/*
 * *******************
 * Check for Updates *
 * *******************
 * Used to check for available updates for JambulaTV
 */

object Service "Available Updates" {
  import "jambula-05-service"

  host_name = "JambulaTV"
  check_command = "updates"

  vars.osd.enabled = "yes"
  vars.osd.message = "Software Updates: A new version of JambulaTV software is available. Please update as soon as possible"
  vars.osd.interval = "3h"
}
