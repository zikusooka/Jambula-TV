alias: System Startup
initial_state: True


trigger:
  platform: homeassistant
  event: start


action:

  # 1. Set the default theme on start up of Home Assistant
  # ------------------------------------------------------
  - service: frontend.set_theme
    data:
      name: pmaxx
      #name: darkblue

  # 2. Wait for voice alerts mixer status to be 'off'
  # -------------------------------------------------
  - wait_for_trigger:
      - platform: state
        entity_id: input_boolean.voice_alerts_mixer_status
        to: "off"
    timeout: 45
    continue_on_timeout: true

  # 3. Set status of voice alerts mixer to 'on'
  # -------------------------------------------
  - service: homeassistant.turn_on
    data:
      entity_id: input_boolean.voice_alerts_mixer_status

  # 4. Run script
  # -------------
  # Reset audio volume to defined initial levels at start time - player
  - service: script.turn_on
    entity_id: script.startup_volume_levels_player
  
  # Reset audio volume to defined initial levels at start time - system
  - service: script.turn_on
    entity_id: script.startup_volume_levels_system

  # Voice alert: Announce startup
  - service: script.turn_on
    entity_id: script.startup_alert_started

  # 5. Set status of voice alerts mixer to 'off'
  # --------------------------------------------
  - service: homeassistant.turn_off
    data:
      entity_id: input_boolean.voice_alerts_mixer_status
