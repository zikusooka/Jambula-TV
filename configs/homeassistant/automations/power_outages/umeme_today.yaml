# Power outages today - planned
alias: "Planned power outage today"
initial_state: True


trigger:

  - platform: time
    at: '00:05:00'

  - platform: template
    value_template: "{{ not is_state('sensor.power_outage_today', 'none') }}"
    for:
      minutes: 1

  - platform: template
    value_template: "{{ not is_state('sensor.power_outage_today', '') }}"
    for:
      minutes: 1


condition:
  condition: and
  conditions:

    # Power outage state not null
    - condition: template
      value_template: "{{ not is_state('sensor.power_outage_today', 'none') }}"
    - condition: template
      value_template: "{{ not is_state('sensor.power_outage_today', '') }}"


    # Time of day
    - condition: time
      before: '23:59:59'


action:

  # Run script
  # ----------
  - service: script.turn_on
    entity_id: script.power_supply_umeme_off_today
