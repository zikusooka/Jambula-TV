music_play_all:
  sequence:

    # Generate 'all' playlist depending on time of year
    - service_template: >
        {% if is_state('sensor.christmas_season', 'True') %}
          shell_command.create_local_music_playlist_with_christmas

        {% else %}
          shell_command.create_local_music_playlist_without_christmas

        {% endif %}
      data:
        music_dir: !secret jambulatv_music_dir
        mpd_playlists_dir: !secret jambulatv_playlists_mpd_dir
        genre: '*'

    # Play 
    - service: media_player.play_media
      data:
        entity_id: media_player.now_playing
        media_content_type: playlist
        media_content_id: 'Local-Music-*'

    # set volume
    - service: media_player.volume_set
      data:
        entity_id: all
        volume_level: !secret mixer_mpd_playlist_volume_level
